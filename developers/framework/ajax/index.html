<!DOCTYPE html><html lang=en><head><meta charset=utf-8><title>Asynchronous Requests &middot; Vanilla Documentation</title><meta name=description content=""><meta name=keywords content=""><meta name=viewport content="width=device-width"><meta name=google-site-verification content=IWfWjN_f_82e7heCa9D0SJRhIf8aZdPNKZm_ympcB54><link rel=stylesheet href="//fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,600,300italic,400italic,600italic|Source+Code+Pro:400,600"><link rel=stylesheet href=/assets/4389d64b.main.css><body><!--[if lt IE 9]>
      <p class="alert alert-warning text-center outdated-browser">You are using an <strong>outdated</strong> browser. Please <a class="alert-link" href="http://outdatedbrowser.com/">upgrade your browser</a> to improve your experience.</p>
    <![endif]--><div id=top></div><nav class="navbar navbar-default navbar-static-top" role=navigation><div class=container><!-- Brand and toggle get grouped for better mobile display --><div class=navbar-header><a class=navbar-brand href="/"><img class=logo src=/assets/img/9bdefa97.logo.svg alt="Vanilla Forums" width=102 height=41> Docs</a></div><div class="collapse navbar-collapse"><div class="navbar-form navbar-left"><div class="dropdown js-search" role=search><div class=form-group><input class="form-control js-search-input" id=docs-search title="Search the documentation" placeholder=Search></div><ul class="dropdown-menu dropdown-search-results js-search-results"><li><a><span class=title></span> <span class=categories></span></a></li></ul></div></div><ul class="nav navbar-nav navbar-right"><li><a href=http://vanillaforums.com>Cloud Hosted Community</a></li><li><a href=http://vanillaforums.org>Open Source Community</a></li></ul></div></div></nav><header class="jumbotron masthead" role=banner><div class=container><h1>Asynchronous Requests</h1></div></header><div class=container><ol class=breadcrumb><li itemscope itemtype=http://data-vocabulary.org/Breadcrumb><a href="/" itemprop=url><span itemprop=title>Home</span></a></li><li itemscope itemtype=http://data-vocabulary.org/Breadcrumb><a href=/developers itemprop=url><span itemprop=title>Developers</span></a></li><li itemscope itemtype=http://data-vocabulary.org/Breadcrumb><a href=/developers/framework itemprop=url><span itemprop=title>Framework</span></a></li><li class=active itemscope itemtype=http://data-vocabulary.org/Breadcrumb><span itemprop=title>Asynchronous Requests</span></li></ol><div class=row><div class=col-sm-2><nav class="docs-nav js-docs-nav" role=navigation><ul class="nav nav-stacked"><li><a href=/addons>Addons</a><ul class="nav nav-stacked"><li><a href=/addons/badges>Badges</a><ul class="nav nav-stacked"><li><a href=/addons/badges/adding-and-editing-badges>Adding and Editing Badges</a></li><li><a href=/addons/badges/giving-and-requesting-badges>Giving and Requesting Badges</a></li></ul></li><li><a href=/addons/gigya>Gigya Sign In</a></li><li><a href=/addons/groups>Groups</a><ul class="nav nav-stacked"><li><a href=/addons/groups/managing-groups>Managing Groups</a></li></ul></li><li><a href=/addons/pockets>Introduction to Pockets</a></li><li><a href=/addons/ranks>Ranks</a><ul class="nav nav-stacked"><li><a href=/addons/ranks/adding-and-editing-ranks>Adding and Editing Ranks</a></li><li><a href=/addons/ranks/applying-ranks-over-sso>Applying Ranks over SSO</a></li><li><a href=/addons/ranks/using-ranks-as-incentives>Using Ranks as Incentives</a></li><li><a href=/addons/ranks/using-ranks-to-defeat-spam-or-abuse>Using Ranks to Defeat Spam or Abuse</a></li></ul></li><li><a href=/addons/reactions>Reactions</a><ul class="nav nav-stacked"><li><a href=/addons/reactions/adding-and-editing-reactions>Adding and Editing Reactions</a></li><li><a href=/addons/reactions/curating-with-reactions>Curating with Reactions</a></li></ul></li><li><a href=/addons/reporting>Reporting</a></li><li><a href=/addons/statistics>Vanilla Statistics</a></li><li><a href=/addons/warnings-and-notes>Warnings and Notes</a><ul class="nav nav-stacked"><li><a href=/addons/warnings-and-notes/adding-and-editing-user-notes>Adding and Editing User Notes</a></li><li><a href=/addons/warnings-and-notes/upgrading-from-warnings>Upgrading from Warnings</a></li><li><a href=/addons/warnings-and-notes/warning-a-user>Warning a User</a></li></ul></li></ul></li><li><a href=/api>API</a><ul class="nav nav-stacked"><li><a href=/api/smart-id>Smart ID</a></li><li><a href=/api/categories>Categories</a></li><li><a href=/api/comments>Comments</a></li><li><a href=/api/discussions>Discussions</a></li><li><a href=/api/forum-administration>Forum Administration</a></li></ul></li><li class=active><a href=/developers>Developers</a><ul class="nav nav-stacked"><li><a href=/developers/changelog>Changelog</a></li><li><a href=/developers/configuration>Configuration</a><ul class="nav nav-stacked"><li><a href=/developers/configuration/using>Using The Config</a></li></ul></li><li><a href=/developers/contributing>Contributing</a><ul class="nav nav-stacked"><li><a href=/developers/contributing/coding-standard>Coding Standard</a></li><li><a href=/developers/contributing/standards>Coding Standards</a></li></ul></li><li><a href=/developers/tools>Developer Tools</a></li><li><a href=/developers/community>Developers Community</a></li><li class=active><a href=/developers/framework>Framework</a><ul class="nav nav-stacked"><li><a href=/developers/framework/assets>Assets</a></li><li class=active><a href=/developers/framework/ajax>Asynchronous Requests</a></li><li><a href=/developers/framework/controllers>Controllers</a></li><li><a href=/developers/framework/database>Database Queries</a></li><li><a href=/developers/framework/dispatcher>Dispatcher</a></li><li><a href=/developers/framework/helpers>Helpers</a></li><li><a href=/developers/framework/inform>Inform Notifications</a></li><li><a href=/developers/framework/i18n>Internationalization &amp; Localization</a></li><li><a href=/developers/framework/models>Models and Forms</a></li><li><a href=/developers/framework/modules>Modules</a></li><li><a href=/developers/framework/permissions>Permissions</a></li><li><a href=/developers/framework/views>Views</a></li></ul></li><li><a href=/developers/importing>Importing</a><ul class="nav nav-stacked"><li><a href=/developers/importing/build>Building new porters</a></li><li><a href=/developers/importing/support>Supported platforms</a></li><li><a href=/developers/importing/porter>Vanilla Porter</a></li></ul></li><li><a href=/developers/installation>Installation</a></li><li><a href=/developers/locales>Locales</a></li><li><a href=/developers/plugins>Plugins</a><ul class="nav nav-stacked"><li><a href=/developers/plugins/quickstart>Plugin Quickstart</a></li></ul></li><li><a href=/developers/troubleshooting>Troubleshooting</a></li></ul></li><li><a href=/features>Features</a><ul class="nav nav-stacked"><li><a href=/features/categories>Categories</a></li><li><a href=/features/embedding>Embedding</a></li><li><a href=/features/mobile>Mobile</a></li><li><a href=/features/moderation>Moderation</a></li><li><a href=/features/notifications>Notifications</a></li><li><a href=/features/setup>Setting Up Your New Forum</a></li><li><a href=/features/sso>Single Sign-On</a></li><li><a href=/features/wordpress>WordPress Integration</a><ul class="nav nav-stacked"><li><a href=/features/wordpress/using-comments>Using Comments</a></li><li><a href=/features/wordpress/wishlist>WishList Integration</a></li></ul></li></ul></li><li><a href=/cloud>Cloud Services</a><ul class="nav nav-stacked"><li><a href=/cloud/integration>Integration Services</a></li><li><a href=/cloud/migration>Migration Services</a></li><li><a href=/cloud/repo>Repository</a></li><li><a href=/cloud/ssl>Setting up SSL (https)</a></li><li><a href=/cloud/staging>Staging Site</a></li><li><a href=/cloud/support>Support</a></li><li><a href=/cloud/theming>Theming Services</a></li></ul></li><li><a href=/theming>Theming</a><ul class="nav nav-stacked"><li><a href=/theming/smarty>Smarty</a><ul class="nav nav-stacked"><li><a href=/theming/smarty/asset>{asset}</a></li><li><a href=/theming/smarty/breadcrumbs>{breadcrumbs}</a></li><li><a href=/theming/smarty/custom-menu>{custom_menu}</a></li><li><a href=/theming/smarty/event>{event}</a></li><li><a href=/theming/smarty/link>{link}</a></li><li><a href=/theming/smarty/logo>{logo}</a></li><li><a href=/theming/smarty/mobile-logo>{mobile_logo}</a></li><li><a href=/theming/smarty/permission>{permission}</a></li><li><a href=/theming/smarty/pocket>{pocket}</a></li><li><a href=/theming/smarty/searchbox>{searchbox}</a></li><li><a href=/theming/smarty/text>{text}</a></li><li><a href=/theming/smarty/i18n>{t}</a></li></ul></li><li><a href=/theming/css>Theming CSS</a></li><li><a href=/theming/hooks>Theming Hooks</a></li><li><a href=/theming/quickstart>Theming Quickstart</a></li><li><a href=/theming/views>Theming Views</a></li></ul></li></ul><p class=hidden-xs><a class=text-muted href=#top><strong>Back to top</strong></a></p></nav></div><div class=col-sm-10><div class="edit-doc pull-right hidden-xs"><a class="btn btn-default btn-xs" href=https://github.com/vanilla/vanilladocs/edit/master/docs/developers/framework/ajax.html.md>Improve document</a></div><article class=markdown-body role=article><h2 id=ajax>Ajax</h2><p>We&#39;ve chosen <a href=http://jquery.com>jQuery</a> as the main javascript library for Vanilla. The jQuery core has a number of <a href=http://docs.jquery.com/Ajax>ajax-related methods</a> that make ajax-based forms and functionality easy as pie. In order to help facilitate partial page loading &amp; updating, We&#39;ve made Vanilla&#39;s base Controller class (the class from which all controllers are extended) accept a DeliveryType parameter on every request. Depending on the type of delivery being requested, a controller in garden will deliver all of a page, part of a page, or part of a page plus extra information as JSON. At the time of this writing, there are four delivery types available:</p><ol><li><code>DELIVERY_TYPE_ALL</code>: Deliver an entire page (a standard request).</li><li><code>DELIVERY_TYPE_ASSET</code>: Deliver all content for the requested asset.</li><li><code>DELIVERY_TYPE_VIEW</code>: Deliver only the requested view.</li><li><code>DELIVERY_TYPE_BOOL</code>: Deliver only the success status of the request as a boolean.</li></ol><p>If no delivery type is provided in the request, <code>DELIVERY_TYPE_ALL</code> is assumed. In our programming for Vanilla 2 and the main Garden management screens, we&#39;ve found that 99% of the time we either use <code>DELIVERY_TYPE_ALL</code> or <code>DELIVERY_TYPE_VIEW</code>. The four delivery types are just constants defined as:</p><pre class=highlight><code class="hljs php">define(<span class=hljs-string>'DELIVERY_TYPE_ALL'</span>, <span class=hljs-number>1</span>);
define(<span class=hljs-string>'DELIVERY_TYPE_ASSET'</span>, <span class=hljs-number>2</span>);
define(<span class=hljs-string>'DELIVERY_TYPE_VIEW'</span>, <span class=hljs-number>3</span>);
define(<span class=hljs-string>'DELIVERY_TYPE_BOOL'</span>, <span class=hljs-number>4</span>);
</code></pre><p>In order to made the controller deliver content other than <code>DELIVERY_TYPE_ALL</code>, you would have to append the request url (or post data) with <code>DeliveryType=3</code> (or whatever type of delivery type you want). The controller will grab this value from whatever collection you send it in and then know how to handle the request. In all four delivery types, the standard response for the controller is to simply take the requested data and spit it to the response. The only exception to this rule is if there is a form posted to the controller. In the case of a form being posted to the controller, it will take the response xhtml and place it into a JSON array along with a couple of other standard bits of information <em>and</em> any extra information that you may want to add. Let&#39;s take a look at some examples of how the delivery type works.</p><h2 id=form-popups>Form Popups</h2><p><img src=http://markosullivan.ca/blog/wp-content/uploads/2008/12/users.gif alt=Users></p><p>In a <code>DELIVERY_TYPE_ALL</code> request, you could be looking at a list of users with an &quot;edit&quot; link next to each of them. You click the edit link, and it takes you to a page that presents you with a form where you can edit all of their information. If you were editing my account, this url might look something like: <code>http://localhost/garden/user/edit/mark</code> This means that you&#39;ve called Garden&#39;s <code>$UserController-&gt;Edit(&#39;mark&#39;);</code> method, and Garden is going to fetch the <code>/garden/views/user/edit.php</code> view file, place it in the <code>views/default.master</code> master view file and deliver everything to the screen. I&#39;ve created a jquery &quot;popup&quot; plugin for Garden that allows you to turn any link in Garden into a view-based popup by applying a &quot;Popup&quot; class to the anchor tag of the link. So, if I had placed that class on the &quot;edit&quot; link next to my username, here&#39;s how the request would be handled by the controller: The jquery-based popup plugin appends a &quot;DeliveryType=3&quot; parameter to the request url and then sends the request. Garden&#39;s <code>$UserController-&gt;Edit(&#39;mark&#39;);</code> method is called, and Garden fetches the <code>/garden/views/user/edit.php</code> view file. At this point it only sends the view back to the popup plugin as a string of xhtml. The popup plugin takes the code from that view file and places it into an element on the page, positioning it above the existing page content. So, without loading a new page I&#39;ve now been presented with the edit user form in an in-page popup.</p><p><img src=http://markosullivan.ca/blog/wp-content/uploads/2008/12/edituser.gif alt="Edit user"></p><p>If I then make changes to the inputs and submit the form, the popup plugin once again hijacks this request, making it an ajax-based request. The controller sees that it only needs to deliver the view once again, and it also sees that a form has been posted back. So, it takes the resulting xhtml and places it into a JSON array to be sent to the response. It also adds extra information to the json array like: (1) a boolean value indicating if the form was saved, (2) a status message, (3) a redirect url, etc. Using these json values the popup can then decide if it should re-present the form with any errors that may have occurred, or hide the form and update data on the underlying page.</p><h2 id=progressive-data-loading>Progressive Data Loading</h2><p>One of the major changes I&#39;ve been working with in Vanilla 2 is progressive data loading. In a standard, non-javascript-based request, I&#39;ve made it so that at the end of a page of comments the user is presented with a &quot;show X more comments&quot; button. When that button is clicked, it takes you to the second, third, nth page of comments. However, if javascript is enabled, jQuery will hijack those button clicks and make the request as a <code>DELIVERY_TYPE_VIEW</code>. It then takes the next page of comments and appends them to the existing comment list directly in the page. These are just two examples of how ajax is integrated into the Garden core. There are a number of other ways that it is used, and I&#39;m adding more methods every day. The ajax code has already been through many revisions, and I anticipate that once the code goes public there will be javascript gurus in the community who will have a lot of great ideas for how to optimize and improve upon what I&#39;ve done.</p></article></div></div></div><footer class="footer js-footer"><div class=jumbotron><div class=container><div class=row><div class=col-sm-6><h3><a href=http://vanillaforums.com>Cloud Hosting</a></h3><p><strong>We believe that online communities should be intuitive, engaging and true to your brand.</strong> Vanilla allows you to create a customized community that rewards positive participation, automatically curates content and lets members drive moderation.</p></div><div class=col-sm-6><h3><a href=http://vanillaforums.org>Open Source</a></h3><p>Vanilla provides cloud and open source community forum software that powers discussion forums on more than 700,000 sites. Built for flexibility and integration, <strong>Vanilla is the best, most powerful community solution in the world.</strong></p></div></div></div></div><div class=footer-copyright><div class=container><p class=text-center>Copyright &copy; 2009-2014 <a href=http://vanillaforums.com>Vanilla Forums Inc.</a> All rights reserved.</p><ul class="list-inline text-center"><li><a href=http://docs.vanillaforums.com>Docs</a></li><li><a href=http://blog.vanillaforums.com>Blog</a></li><li><a href=http://vanillaforums.com>Cloud</a></li><li><a href=http://vanillaforums.org>Community</a></li><li><a href=https://github.com/vanilla>GitHub</a></li><li><a href=https://github.com/vanilla/vanilla/issues>Issues</a></li></ul></div></div></footer><script src=/assets/3d3a6616.main.js></script><!-- Google Analytics --><script>!function(e,a,t,n,c,o,s){e.GoogleAnalyticsObject=c,e[c]=e[c]||function(){(e[c].q=e[c].q||[]).push(arguments)},e[c].l=1*new Date,o=a.createElement(t),s=a.getElementsByTagName(t)[0],o.async=1,o.src=n,s.parentNode.insertBefore(o,s)}(window,document,"script","//www.google-analytics.com/analytics.js","ga"),ga("create","UA-12713112-1","auto"),ga("send","pageview");</script>