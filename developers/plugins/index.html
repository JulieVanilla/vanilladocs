<!DOCTYPE html><html lang=en><head><meta charset=utf-8><title>Plugins &middot; Vanilla Documentation</title><meta name=description content=""><meta name=viewport content="width=device-width"><link rel="shortcut icon" href=/assets/img/favicon.ico><link rel=stylesheet href="//fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,600,300italic,400italic,600italic"><link rel=stylesheet href=/assets/73ef2dc5.main.css><body><!--[if lt IE 9]>
      <p class="browsehappy">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p>
    <![endif]--><div id=top></div><nav class="navbar navbar-default navbar-static-top" role=navigation><div class=container><!-- Brand and toggle get grouped for better mobile display --><div class=navbar-header><button type=button class=navbar-toggle data-toggle=collapse><span class=sr-only>Toggle navigation</span> <span class=icon-bar></span> <span class=icon-bar></span> <span class=icon-bar></span></button> <a class=navbar-brand href="/"><img class=logo src=/assets/img/logo.svg alt="Vanilla Forums"> Docs</a></div><!-- Collect the nav links, forms, and other content for toggling --><div class="collapse navbar-collapse"><div class="navbar-form navbar-left"><div id=search-docs class="dropdown{{hasResults ? ' open' : ' closed'}}" role=search><div class=form-group><input v-on=input:search class=form-control id=docs-search title="Search the documentation" placeholder=Search></div><ul class="dropdown-menu dropdown-search-results"><li v-repeat=results><a href={{url}}><span class=title>{{title}}</span> <span class=categories>{{categories.join(' / ')}}</span></a></li></ul></div></div><ul class="nav navbar-nav navbar-right"><li><a href=http://vanillaforums.com>Cloud Hosted Community</a></li><li><a href=http://vanillaforums.org>Open Source Community</a></li></ul></div></div></nav><header class="jumbotron masthead" role=banner><div class=container><h1>Plugins</h1></div></header><div class=container><ol class=breadcrumb><li itemscope itemtype=http://data-vocabulary.org/Breadcrumb><a href="/" itemprop=url><span itemprop=title>Home</span></a></li><li itemscope itemtype=http://data-vocabulary.org/Breadcrumb><a href=/developers itemprop=url><span itemprop=title>Developers</span></a></li><li class=active itemscope itemtype=http://data-vocabulary.org/Breadcrumb><span itemprop=title>Plugins</span></li></ol><div class=row><div class=col-sm-2><nav class="docs-nav js-docs-nav" role=navigation><ul class="nav nav-stacked"><li><a href=/addons>Addons</a><ul class="nav nav-stacked"><li><a href=/addons/badges>Badges</a><ul class="nav nav-stacked"><li><a href=/addons/badges/adding-and-editing-badges>Adding and Editing Badges</a></li><li><a href=/addons/badges/giving-and-requesting-badges>Giving and Requesting Badges</a></li></ul></li><li><a href=/addons/groups>Groups</a><ul class="nav nav-stacked"><li><a href=/addons/groups/managing-groups>Managing Groups</a></li></ul></li><li><a href=/addons/gigya>Gigya Sign In</a></li><li><a href=/addons/pockets>Introduction to Pockets</a></li><li><a href=/addons/ranks>Ranks</a><ul class="nav nav-stacked"><li><a href=/addons/ranks/adding-and-editing-ranks>Adding and Editing Ranks</a></li><li><a href="/addons/ranks/applying-ranks-over sso">Applying Ranks over SSO</a></li><li><a href=/addons/ranks/using-ranks-as-incentives>Using Ranks as Incentives</a></li><li><a href=/addons/ranks/using-ranks-to-defeat-spam-or-abuse>Using Ranks to Defeat Spam or Abuse</a></li></ul></li><li><a href=/addons/reactions>Reactions</a><ul class="nav nav-stacked"><li><a href=/addons/reactions/curating-with-reactions>Curating with Reactions</a></li><li><a href=/addons/reactions/adding-and-editing-reactions>Adding and Editing Reactions</a></li></ul></li><li><a href=/addons/reporting>Reporting</a></li><li><a href=/addons/statistics>Vanilla Statistics</a></li><li><a href=/addons/warnings-and-notes>Warnings and Notes</a><ul class="nav nav-stacked"><li><a href=/addons/warnings-and-notes/adding-and-editing-user-notes>Adding and Editing User Notes</a></li><li><a href=/addons/warnings-and-notes/upgrading-from-warnings>Upgrading from Warnings</a></li><li><a href=/addons/warnings-and-notes/warning-a-user>Warning a User</a></li></ul></li></ul></li><li><a href=/api>API</a><ul class="nav nav-stacked"><li><a href=/api/forum-administration>Forum Administration</a></li><li><a href=/api/smart-id>Smart ID</a></li><li><a href=/api/categories>Categories</a></li><li><a href=/api/comments>Comments</a></li><li><a href=/api/discussions>Discussions</a></li></ul></li><li><a href=/cloud>Cloud Services</a><ul class="nav nav-stacked"><li><a href=/cloud/integration>Integration Services</a></li><li><a href=/cloud/migration>Migration Services</a></li><li><a href=/cloud/repo>Repository</a></li><li><a href=/cloud/ssl>Setting up SSL (https)</a></li><li><a href=/cloud/staging>Staging Site</a></li><li><a href=/cloud/support>Support</a></li><li><a href=/cloud/theming>Theming Services</a></li></ul></li><li class=active><a href=/developers>Developers</a><ul class="nav nav-stacked"><li><a href=/developers/changelog>Changelog</a></li><li><a href=/developers/troubleshooting>Troubleshooting</a></li><li><a href=/developers/installation>Installation</a></li><li><a href=/developers/locales>Locales</a></li><li><a href=/developers/tools>Developer Tools</a></li><li><a href=/developers/community>Developers Community</a></li><li><a href=/developers/contributing>Contributing</a><ul class="nav nav-stacked"><li><a href=/developers/contributing/coding-standard>Coding Standard</a></li><li><a href=/developers/contributing/standards>Coding Standards</a></li></ul></li><li><a href=/developers/framework>Framework</a><ul class="nav nav-stacked"><li><a href=/developers/framework/ajax>Asynchronous Requests</a></li><li><a href=/developers/framework/views>Views</a></li><li><a href=/developers/framework/controllers>Controllers</a></li><li><a href=/developers/framework/database>Database Queries</a></li><li><a href=/developers/framework/dispatcher>Dispatcher</a></li><li><a href=/developers/framework/helpers>Helpers</a></li><li><a href=/developers/framework/assets>Assets</a></li><li><a href=/developers/framework/inform>Inform Notifications</a></li><li><a href=/developers/framework/models>Models and Forms</a></li><li><a href=/developers/framework/modules>Modules</a></li><li><a href=/developers/framework/permissions>Permissions</a></li><li><a href=/developers/framework/i18n>Internationalization &amp; Localization</a></li></ul></li><li><a href=/developers/importing>Importing</a><ul class="nav nav-stacked"><li><a href=/developers/importing/build>Building new porters</a></li><li><a href=/developers/importing/porter>Vanilla Porter</a></li><li><a href=/developers/importing/support>Supported platforms</a></li></ul></li><li class=active><a href=/developers/plugins>Plugins</a><ul class="nav nav-stacked"><li><a href=/developers/plugins/quickstart>Plugin Quickstart</a></li></ul></li><li><a href=/developers/configuration>Configuration</a><ul class="nav nav-stacked"><li><a href=/developers/configuration/using>Using The Config</a></li></ul></li></ul></li><li><a href=/features>Features</a><ul class="nav nav-stacked"><li><a href=/features/categories>Categories</a></li><li><a href=/features/embedding>Embedding</a></li><li><a href=/features/mobile>Mobile</a></li><li><a href=/features/sso>Single Sign-On</a></li><li><a href=/features/moderation>Moderation</a></li><li><a href=/features/setup>Setting Up Your New Forum</a></li><li><a href=/features/notifications>Notifications</a></li><li><a href=/features/wordpress>WordPress Integration</a><ul class="nav nav-stacked"><li><a href=/features/wordpress/using-comments>Using Comments</a></li><li><a href=/features/wordpress/wishlist>WishList Integration</a></li></ul></li></ul></li><li><a href=/theming>Theming</a><ul class="nav nav-stacked"><li><a href=/theming/css>Theming CSS</a></li><li><a href=/theming/hooks>Theming Hooks</a></li><li><a href=/theming/quickstart>Theming Quickstart</a></li><li><a href=/theming/views>Theming Views</a></li><li><a href=/theming/smarty>Smarty</a><ul class="nav nav-stacked"><li><a href=/theming/smarty/asset>{asset}</a></li><li><a href=/theming/smarty/text>{text}</a></li><li><a href=/theming/smarty/custom-menu>{custom_menu}</a></li><li><a href=/theming/smarty/event>{event}</a></li><li><a href=/theming/smarty/i18n>{t}</a></li><li><a href=/theming/smarty/link>{link}</a></li><li><a href=/theming/smarty/breadcrumbs>{breadcrumbs}</a></li><li><a href=/theming/smarty/mobile-logo>{mobile_logo}</a></li><li><a href=/theming/smarty/permission>{permission}</a></li><li><a href=/theming/smarty/pocket>{pocket}</a></li><li><a href=/theming/smarty/searchbox>{searchbox}</a></li><li><a href=/theming/smarty/logo>{logo}</a></li></ul></li></ul></li></ul><p><a class=text-muted href=#top><strong>Back to top</strong></a></p></nav></div><div class=col-sm-10><div class="edit-doc pull-right"><a class="btn btn-default btn-xs" href=https://github.com/vanilla/vanilladocs/edit/master/docs/developers/plugins/index.html.md>Improve document</a></div><article class=markdown-body role=article><p><h2>Plugins</h2></p><p>Before development on Garden began, I spent a lot of time <a href="http://markosullivan.ca/blog/?p=77">thinking about</a> how to improve upon the plugin architecture adopted for Vanilla 1, and then I spent even more time doing <a href="http://markosullivan.ca/blog/?p=206">test after test after test</a> to see what really worked. In the end I realized that there can easily be more than one way to accomplish the task, so I&#39;ve adopted a few standards, and I&#39;ve left the code open to new methods of plugging in that some of you may decide to pursue. For now, I&#39;ll talk about four different ways of plugging in.</p><h2>1. Custom Events</h2><p>Any class that extends the class &quot;Pluggable&quot; has the ability to call <code>$this-&gt;FireEvent(&#39;EventName&#39;)</code>, and then plugins can attach to that event to perform some kind of operation. There should be no surprises here. There is a PluginManager class that picks up any defined plugins in the bootstrapper file (the file that includes core classes, defines constants, defines configuration settings, etc), and when the FireEvent method is called, it references the PluginManager class to see if there are any plugins that want to attach to the event name being fired. Of course it passes along some extra information that may be useful to the plugins as well:</p>public function FireEvent($EventName) { // Look to the PluginManager to see if there are related // event handlers and call them: $this-&gt;PluginManager-&gt;CallEventHandlers( $this, $this-&gt;ClassName, $EventName, $this-&gt;EventArguments ); }<p>Custom events are being added on a case-by-case basis as the need arises. If you feel you need a new Event, request it on the community forum. However, you should also consider if you could use...</p><h2>2. Magic Events</h2><p>Magic events are new in Garden, and they are based around some trickery I&#39;ve come up with using PHP&#39;s magic <a href=http://ca.php.net/__call><strong>call</strong></a> method. For those of you who don&#39;t know what PHP&#39;scall method does, here is a quick breakdown: When you attempt to call a method on an object that does not have that method (PHP refers to these as &quot;inaccessible methods&quot;), the <strong>call method is fired as: <code>$Object-&gt;</code></strong>call($Name, $Arguments) where $Name is the name of the method that was called but didn&#39;t exist, and $Arguments is an enumerated array of the arguments passed to that method. In Garden, I&#39;ve taken advantage of <strong>call to achieve what I&#39;ve called &quot;magic events&quot;. There are two types of magic events in Garden: &quot;Declared&quot; and &quot;Called&quot;.</strong></p><h2>2a. Declared Magic Events</h2><p>The theory behind declared magic events is that I can mis-name a method declaration by prefixing it with a pre-defined character (in Garden I&#39;ve used &quot;x&quot; as the standard character). Then, when the class is instantiated, and that method is called without the &quot;x&quot; before the name, Pluggable&#39;scall method is fired. Within the <strong>call method, Pluggable looks to the PluginManager to see if any plugins have attached to one of three automatic methods: Before, Override, and After. Let&#39;s take a look at an example of how this might work:</strong></p>// Imagine this class is a core Garden class class MyFancyClass extends Pluggable { public function <strong>x</strong>Tickle() { echo &#39;You just tickled my fancy!&#39;; } } $MyFancy = new MyFancyClass(); $MyFancy-&gt;Tickle(); // would typically render: // You just tickled my fancy!<p>Now, let&#39;s say I want to do something any time that method is called. For example, let&#39;s say I want to prefix that message with a salutation like &quot;Hey stranger, &quot;. I could easily do that by creating a plugin like so:</p>// Define the plugin: $PluginInfo[&#39;SuperFancifier&#39;] = array( &#39;Description&#39; =&gt; &#39;Adds some niceties onto MyFancyClass.&#39;, &#39;Version&#39; =&gt; &#39;1.0&#39;, &#39;RequiredPlugins&#39; =&gt; FALSE, // This is an array of plugin names/versions that this plugin requires &#39;HasLocale&#39; =&gt; FALSE, // Does this plugin have any locale definitions? &#39;RegisterPermissions&#39; =&gt; FALSE, // Permissions that should be added for this plugin. &#39;SettingsUrl&#39; =&gt; FALSE, // Url of the plugin&#39;s settings page. &#39;SettingsPermission&#39; =&gt; FALSE, // The permission required to view the SettingsUrl. &#39;Author&#39; =&gt; &quot;Mark O&#39;Sullivan&quot;, &#39;AuthorEmail&#39; =&gt; &#39;mark@lussumo.com&#39;, &#39;AuthorUrl&#39; =&gt; &#39;<a href=http://markosullivan.ca>http://markosullivan.ca</a>&#39; ); class SuperFancifierPlugin extends Gdn_Plugin { public function MyFancyClass_Tickle_Before($Sender) { echo &#39;Hey Stranger, &#39;; } }<p>The first thing you see in this plugin is a definition for this plugin that is added to a &quot;PluginInfo&quot; array. There is a lot more information here than you might be used to coming from Vanilla 1. But, hopefully, it all looks fairly straightforward to you. I define the plugin&#39;s name, description, author, author info, permissions, settings url, etc. All of these are customizable, and only the name, description, and plugin author are required. Everything else is there simply to help make your plugin more reliable and easier to implement. Furthermore, since a lot of these are new and changing every day, I&#39;ll leave their explanation until the core is finished and the documentation is written. Let&#39;s get back on track by looking at my actual plugin class code. As you can see, I&#39;ve created a class called SuperFancifierPlugin that extends the Gdn_Plugin base class. Using reflection, the PluginManager class can examine all declared classes to see which ones implement the IPlugin interface (which Gdn_Plugin does). After it finds all of them, it examines their methods. In this example, the PluginManager would find the SuperFancifierPlugin and it&#39;s MyFancyClass_BeforeTickle_Handler method. It would break apart the method name based on the underscores and know that (a) it is trying to plug in to the &quot;MyFancyClass&quot; class, and (b) it wants to fire the method &quot;Before&quot; MyFancyClass&#39; Tickle() method. The plugin manager knows all of this before MyFancyClass has even been included. It simply keeps a record of all plugins and all classes/methods they want to attach to. So, in the example above, after this plugin is included in the Garden bootstrapper, the following would happen:</p>$MyFancy = new MyFancyClass(); $MyFancy-&gt;Tickle(); // would now render: // Hey Stranger, You just tickled my fancy!<p>I could take it a step further and add something afterwards like so:</p>class SuperFancifierPlugin extends Gdn_Plugin { public function MyFancyClass_Tickle_Before($Sender) { echo &#39;Hey Stranger, &#39;; } public function MyFancyClass_Tickle_After($Sender) { echo &quot;nWasn&#39;t that nice of you!?&quot;; } }<p>Which would make the following happen:</p>$MyFancy = new MyFancyClass(); $MyFancy-&gt;Tickle(); // would now render: // Hey Stranger, You just tickled my fancy! // Wasn&#39;t that nice of you!?<p>And finally, I could completely change everything by overriding the Tickle method like so:</p>class SuperFancifierPlugin extends Gdn_Plugin { public function MyFancyClass_Tickle_Override($Sender) { echo &#39;I&#39;ve overridden your fancy tickler.&#39;; } }<p>Which would result in the following:</p>$MyFancy = new MyFancyClass(); $MyFancy-&gt;Tickle(); // would now render: // I&#39;ve overridden your fancy tickler.<h2>2b. Called Magic Events</h2><p>So, you&#39;ve seen how a declared magic event forces Pluggable&#39;scall method to fire whenever the &quot;real&quot; (non-x&#39;d) name of the method is called. Now let&#39;s talk about the flipside to that coin: called magic events. A &quot;called&quot; magic event happens when a class method is declared <strong>without</strong> the &quot;x&quot; before the name, but is called <strong>with</strong> the &quot;x&quot; before the name. For example:</p>class MyFancyClass extends Pluggable { public function Tickle() { echo &#39;You just tickled my fancy!&#39;; } } $MyFancy = new MyFancyClass(); $MyFancy-&gt;<strong>x</strong>Tickle(); // would typically render: // You just tickled my fancy! // Unless I had my override plugin enabled, in which case it would render: // I&#39;ve overridden your fancy tickler.<p>So, what&#39;s the difference between a called magic event and a declared magic event? It&#39;s quite a large difference, actually. With a declared magic event, the plugin would be guaranteed to attach whenever that method is referenced. However, with a &quot;called&quot; magic event, the plugin would only attach if the method was called with the &quot;x&quot; prefix. At the time of this writing, there are no called magic events in Garden. I am thinking that I will add them as necessary just like custom events. Furthermore, I&#39;ve only used declared magic events with the Controller class&#39; Render and FetchView methods as these are the only places I&#39;ve needed them so far. Of course, as time passes, I&#39;m sure we will find more places to add all three types of events.</p><h2>3. Function Overrides</h2><p>I would have liked it if there were no functions in Garden. In my mind, functions should be in a class even if it is a static utility class that refers to the methods just like you would if they were functions. However, when I started writing Garden (and still today), PHP was lacking some things that I think would be necessary in order to put functions into a static utility class. For example, <strong>callStatic isn&#39;t production-ready, yet. So there would be no way to override functions if they were in a static class. So, as you may have seen in any of the other PHP-based frameworks out there, I&#39;ve provided a last-ditch effort to allow plugin authors to override functions: function overrides. Simply put, all functions in Garden are declared like so:</strong></p>if (!function_exists(&#39;FunctionName&#39;)) { function FunctionName() {} }<p>So, the plugin author has the ability to override any core function simply by defining it before the framework does.</p><h2>4. Magic Methods</h2><p>Finally, we come to magic methods. Imagine that there is a controller in Garden that doesn&#39;t perform some task that you think is necessary. For example, what if I had created a UserController controller that only had methods to search for users, show users, and edit users. What if you wanted that controller to have a method to add a new user? That&#39;s where magic methods come into play. Magic methods in Garden essentially allow you to create new methods and add them to existing objects. They are created in much the same way that you plug into events. Using the MyFancyTickler class example above, what if I wanted to create a method on that class so that I could massage my fancy? I could create a plugin like so:</p>class MassageMyFancyPlugin extends Gdn_Plugin { public function MyFancyClass_Massage_Create($Sender) { echo &quot;I&#39;m massaging my fancy...&quot;; } }<p>That&#39;s it. With this plugin enabled, you could now do the following:</p>class MyFancyClass extends Pluggable { public function Tickle() { echo &#39;You just tickled my fancy!&#39;; } } $MyFancy = new MyFancyClass(); $MyFancy-&gt;Massage(); // And it would render: // I&#39;m massaging my fancy...<h2>Conclusion</h2><p>There are still things I could tell you about other ways to use the Pluggable class, but I think that&#39;s enough for today. I know that some of you are probably worried that the magic methods will be too heavy on the server (this is a common complaint amongst the PHP developer community), but I&#39;ve <a href="http://markosullivan.ca/blog/?p=206">done my own homework</a> that has helped me to both speed up my implementation ofcall, and prove to me that (when used properly) it&#39;s effects on speed are negligible. The bottom line is that when you see how it can be used, the benefits far outweigh the loss. I seriously can&#39;t wait to see what type of plugins the community comes up with for Garden. Imagine the possibilities!</p><h2>Your first plugin...</h2><p>Now that you know what a plugin is, and some of the things you can do with them, why not check out the [[pluginquickstart|Plugin Quick Start Guide]] to get the ball rolling?</p></article></div></div></div><footer class="footer js-footer"><div class=jumbotron><div class=container><div class=row><div class=col-sm-6><h3><a href=#>Cloud Hosting</a></h3><p><strong>We believe that online communities should be intuitive, engaging and true to your brand.</strong> Vanilla allows you to create a customized community that rewards positive participation, automatically curates content and lets members drive moderation.</p></div><div class=col-sm-6><h3><a href=#>Open Source</a></h3><p>Vanilla provides cloud and open source community forum software that powers discussion forums on more than 700,000 sites. Built for flexibility and integration, <strong>Vanilla is the best, most powerful community solution in the world.</strong></p></div></div></div></div><div class=footer-copyright><div class=container><p class=text-center>Copyright &copy; 2009-2014 <a href=//vanillaforums.com>Vanilla Forums Inc.</a> All rights reserved.</p><ul class="list-inline text-center"><li><a href=//docs.vanillaforums.com>Docs</a></li><li><a href=//blog.vanillaforums.com>Blog</a></li><li><a href=//vanillaforums.com>Cloud</a></li><li><a href=//vanillaforums.org>Community</a></li><li><a href=https://github.com/vanilla>GitHub</a></li><li><a href=https://github.com/vanilla/vanilla/issues>Issues</a></li></ul></div></div></footer><script src=/assets/974b85ae.main.js></script>